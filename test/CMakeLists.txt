FIND_PACKAGE(
	Boost 1.40.0 REQUIRED COMPONENTS
	unit_test_framework
)

MACRO(
	ADD_MIZUIRO_TEST
	PATHNAME
)
	STRING(REGEX REPLACE "\\/" "_" TESTNAME ${PATHNAME})

	SET(MIZUIRO_TEST_NAME test_${TESTNAME}test)

	ADD_EXECUTABLE (${MIZUIRO_TEST_NAME} ${PATHNAME}.cpp)

	IF(MSVC)
		SET_PROPERTY(
			TARGET ${MIZUIRO_TEST_NAME}
			PROPERTY COMPILE_FLAGS
			"-DBOOST_TEST_NO_LIB -DBOOST_TEST_MODULE=${TESTNAME}"
		)
	ELSE()
		SET_PROPERTY(
			TARGET ${MIZUIRO_TEST_NAME}
			PROPERTY COMPILE_FLAGS
			"-DBOOST_TEST_DYN_LINK -DBOOST_TEST_MODULE=${TESTNAME}"
		)
	ENDIF()

	TARGET_LINK_LIBRARIES (
		${MIZUIRO_TEST_NAME}
		${MIZUIRO_DEFAULT_LINK_TARGET}
		${Boost_UNIT_TEST_FRAMEWORK_LIBRARY}
	)

	ADD_TEST(
		NAME
		${MIZUIRO_TEST_NAME}
		COMMAND
		${MIZUIRO_TEST_NAME}
	)
ENDMACRO()

ADD_MIZUIRO_TEST(convert/shuffle)
ADD_MIZUIRO_TEST(empty_view)
ADD_MIZUIRO_TEST(views_are_compatible)
